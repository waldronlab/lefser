<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>R implementation of the LEfSe method — lefser • lefser</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="R implementation of the LEfSe method — lefser"><meta property="og:description" content="Perform a LEfSe analysis: the function carries out differential analysis
between two sample groups for multiple microorganisms and uses linear discirminant analysis
to establish their effect sizes. Subclass information for each class can be incorporated
into the analysis (see examples). Microorganisms with large differences between two sample groups
are identified as biomarkers."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90028752-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-90028752-3');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lefser</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/lefser.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/waldronlab/lefser/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>R implementation of the LEfSe method</h1>
    <small class="dont-index">Source: <a href="https://github.com/waldronlab/lefser/blob/HEAD/R/lefser.R" class="external-link"><code>R/lefser.R</code></a></small>
    <div class="hidden name"><code>lefser.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a LEfSe analysis: the function carries out differential analysis
between two sample groups for multiple microorganisms and uses linear discirminant analysis
to establish their effect sizes. Subclass information for each class can be incorporated
into the analysis (see examples). Microorganisms with large differences between two sample groups
are identified as biomarkers.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lefser</span><span class="op">(</span></span>
<span>  <span class="va">relab</span>,</span>
<span>  kruskal.threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  wilcox.threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  lda.threshold <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  groupCol <span class="op">=</span> <span class="st">"GROUP"</span>,</span>
<span>  blockCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  trim.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  checkAbundances <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">expr</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>relab</dt>
<dd><p>A SummarizedExperiment with relative
abundances in the assay</p></dd>


<dt>kruskal.threshold</dt>
<dd><p>numeric(1) The p-value for the Kruskal-Wallis Rank
Sum Test (default 0.05).</p></dd>


<dt>wilcox.threshold</dt>
<dd><p>numeric(1) The p-value for the Wilcoxon Rank-Sum Test
when 'blockCol' is present (default 0.05).</p></dd>


<dt>lda.threshold</dt>
<dd><p>numeric(1) The effect size threshold (default 2.0).</p></dd>


<dt>groupCol</dt>
<dd><p>character(1) Column name in <code>colData(relab)</code> indicating
groups, usually a factor with two levels (e.g., <code>c("cases", "controls")</code>;
default "GROUP").</p></dd>


<dt>blockCol</dt>
<dd><p>character(1) Optional column name in <code>colData(relab)</code>
indicating the blocks, usually a factor with two levels (e.g.,
<code>c("adult", "senior")</code>; default NULL).</p></dd>


<dt>assay</dt>
<dd><p>The i-th assay matrix in the <code>SummarizedExperiment</code> ('relab';
default 1).</p></dd>


<dt>trim.names</dt>
<dd><p>If <code>TRUE</code> extracts the most specific taxonomic rank of organism.</p></dd>


<dt>checkAbundances</dt>
<dd><p><code>logical(1)</code> Whether to check if the assay data in the
<code>relab</code> input are relative abundances or counts. If counts are found, a
warning will be emitted (default <code>TRUE</code>).</p></dd>


<dt>expr</dt>
<dd><p>(<code>deprecated</code>) Use <code>relab</code> instead. A SummarizedExperiment
with relative abundances in the assay</p></dd>


<dt>...</dt>
<dd><p>Additional inputs to lower level functions (not used).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a <code>data.frame</code> with two columns, which are
names of microorganisms and their LDA scores.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The LEfSe method expects relative abundances in the <code>expr</code> input. A warning
will be emitted if the column sums do not result in 1. Use the <code>relativeAb</code>
helper function to convert the data in the <code>SummarizedExperiment</code> to relative
abundances. The <code>checkAbundances</code> argument enables checking the data
for presence of relative abundances and can be turned off by setting the
argument to <code>FALSE</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>    <span class="co"># (1) Using classes only</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">zeller14</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># exclude 'adenoma'</span></span></span>
<span class="r-in"><span>    <span class="va">zeller14</span> <span class="op">&lt;-</span> <span class="va">zeller14</span><span class="op">[</span>, <span class="va">zeller14</span><span class="op">$</span><span class="va">study_condition</span> <span class="op">!=</span> <span class="st">"adenoma"</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">res_group</span> <span class="op">&lt;-</span> <span class="fu">lefser</span><span class="op">(</span><span class="va">zeller14</span>, groupCol <span class="op">=</span> <span class="st">"study_condition"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Convert counts to relative abundances with 'relativeAb()'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The outcome variable is specified as 'study_condition' and the reference category is 'CRC'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  See `?factor` or `?relevel` to change the reference category.</span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                                                                 Names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                                                         k__Bacteria|p__Bacteroidetes|c__Bacteroidia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                                        k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                                                                        k__Bacteria|p__Bacteroidetes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                                  k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Porphyromonadaceae</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                  k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Coprococcus|s__Coprococcus_eutactus</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Coprococcus|s__Coprococcus_eutactus|t__GCF_000154425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      scores</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -6.347444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -6.347444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -6.347413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -5.722422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -5.575588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -5.559177</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># (2) Using classes and sublasses</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">zeller14</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># exclude 'adenoma'</span></span></span>
<span class="r-in"><span>    <span class="va">zeller14</span> <span class="op">&lt;-</span> <span class="va">zeller14</span><span class="op">[</span>, <span class="va">zeller14</span><span class="op">$</span><span class="va">study_condition</span> <span class="op">!=</span> <span class="st">"adenoma"</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">res_block</span> <span class="op">&lt;-</span> <span class="fu">lefser</span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="va">zeller14</span>, groupCol <span class="op">=</span> <span class="st">"study_condition"</span>, blockCol <span class="op">=</span> <span class="st">"age_category"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Convert counts to relative abundances with 'relativeAb()'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The outcome variable is specified as 'study_condition' and the reference category is 'CRC'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  See `?factor` or `?relevel` to change the reference category.</span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_block</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                                                                                                                Names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                                                                k__Bacteria|p__Fusobacteria|c__Fusobacteriia|o__Fusobacteriales|f__Fusobacteriaceae</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                                               k__Bacteria|p__Fusobacteria|c__Fusobacteriia|o__Fusobacteriales|f__Fusobacteriaceae|g__Fusobacterium</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                                                k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Porphyromonadaceae|g__Porphyromonas</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                               k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Porphyromonadaceae|g__Porphyromonas|s__Porphyromonas_asaccharolytica</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Porphyromonadaceae|g__Porphyromonas|s__Porphyromonas_asaccharolytica|t__Porphyromonas_asaccharolytica_unclassified</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                                                                                                                                       k__Bacteria|p__Fusobacteria|c__Fusobacteriia</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      scores</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -5.267833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -5.228945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -4.998489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -4.927101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -4.899673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -4.870512</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Asya Khleborodova.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

